<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - Vidyavantra</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      min-height: 100vh;
    }

    /* Sidebar */
    .sidebar {
      position: fixed;
      left: 0;
      top: 0;
      width: 280px;
      height: 100vh;
      background: linear-gradient(180deg, #667eea 0%, #764ba2 100%);
      color: white;
      z-index: 1000;
      transition: transform 0.3s ease;
      overflow-y: auto;
    }

    .sidebar.collapsed {
      transform: translateX(-280px);
    }

    .sidebar-header {
      padding: 30px 25px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .logo {
      font-size: 1.8rem;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .logo-subtitle {
      font-size: 0.9rem;
      opacity: 0.8;
    }

    .nav-menu {
      padding: 20px 0;
    }

    .nav-item {
      display: flex;
      align-items: center;
      padding: 15px 25px;
      color: rgba(255, 255, 255, 0.8);
      text-decoration: none;
      transition: all 0.3s ease;
      border-left: 3px solid transparent;
    }

    .nav-item:hover,
    .nav-item.active {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border-left-color: #f093fb;
    }

    .nav-item i {
      font-size: 1.2rem;
      margin-right: 15px;
      width: 20px;
    }

    .user-profile {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 20px 25px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .profile-info {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .profile-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      background: linear-gradient(45deg, #f093fb, #f5576c);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      font-weight: bold;
    }

    .profile-details h4 {
      font-size: 0.95rem;
      margin-bottom: 2px;
    }

    .profile-details p {
      font-size: 0.8rem;
      opacity: 0.7;
    }

    /* Main Content */
    .main-content {
      margin-left: 280px;
      transition: margin-left 0.3s ease;
      min-height: 100vh;
    }

    .main-content.expanded {
      margin-left: 0;
    }

    /* Header */
    .header {
      background: white;
      padding: 20px 30px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .menu-toggle {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: #333;
      display: none;
    }

    .page-title {
      font-size: 1.8rem;
      color: #333;
      font-weight: 600;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .search-box {
      position: relative;
    }

    .search-box input {
      padding: 10px 40px 10px 15px;
      border: 2px solid #e1e5e9;
      border-radius: 25px;
      width: 300px;
      font-size: 0.9rem;
      transition: all 0.3s ease;
    }

    .search-box input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .search-icon {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: #666;
    }

    .notification-btn {
      position: relative;
      background: none;
      border: none;
      font-size: 1.3rem;
      color: #666;
      cursor: pointer;
      padding: 8px;
      border-radius: 50%;
      transition: all 0.3s ease;
    }

    .notification-btn:hover {
      background: #f8f9fa;
    }

    .notification-badge {
      position: absolute;
      top: 0;
      right: 0;
      background: #dc3545;
      color: white;
      border-radius: 50%;
      width: 18px;
      height: 18px;
      font-size: 0.7rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Dashboard Content */
    .dashboard-content {
      padding: 30px;
    }

    /* Stats Cards */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 25px;
      margin-bottom: 40px;
    }

    .stat-card {
      background: white;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
    }

    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(45deg, #667eea, #764ba2);
    }

    .stat-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .stat-icon {
      width: 50px;
      height: 50px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      color: white;
    }

    .stat-icon.courses { background: linear-gradient(45deg, #667eea, #764ba2); }
    .stat-icon.progress { background: linear-gradient(45deg, #f093fb, #f5576c); }
    .stat-icon.certificates { background: linear-gradient(45deg, #4facfe, #00f2fe); }
    .stat-icon.hours { background: linear-gradient(45deg, #43e97b, #38f9d7); }

    .stat-value {
      font-size: 2.2rem;
      font-weight: bold;
      color: #333;
      margin-bottom: 5px;
    }

    .stat-label {
      color: #666;
      font-size: 0.9rem;
    }

    .stat-change {
      font-size: 0.8rem;
      padding: 4px 8px;
      border-radius: 20px;
      font-weight: 500;
    }

    .stat-change.positive {
      background: #d4edda;
      color: #155724;
    }

    .stat-change.negative {
      background: #f8d7da;
      color: #721c24;
    }

    /* Content Grid */
    .content-grid {
      display: grid;
      /* Single column layout now that Continue Learning was removed */
      grid-template-columns: 1fr;
      gap: 30px;
      margin-bottom: 40px;
    }

    /* Recent Courses */
    .section-card {
      background: white;
      border-radius: 15px;
      padding: 30px;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
    }

    .section-title {
      font-size: 1.4rem;
      color: #333;
      font-weight: 600;
    }

    .view-all-btn {
      color: #667eea;
      text-decoration: none;
      font-size: 0.9rem;
      font-weight: 500;
      transition: color 0.3s ease;
    }

    .view-all-btn:hover {
      color: #764ba2;
    }

    .course-item {
      display: flex;
      align-items: center;
      padding: 20px 0;
      border-bottom: 1px solid #f1f3f4;
    }

    .course-item:last-child {
      border-bottom: none;
    }

    .course-thumbnail {
      width: 60px;
      height: 60px;
      border-radius: 10px;
      background: linear-gradient(45deg, #667eea, #764ba2);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.2rem;
      margin-right: 15px;
    }

    .course-info {
      flex: 1;
    }

    .course-title {
      font-weight: 600;
      color: #333;
      margin-bottom: 5px;
    }

    .course-meta {
      font-size: 0.8rem;
      color: #666;
    }

    .course-progress {
      width: 80px;
      text-align: right;
    }

    .progress-bar {
      width: 100%;
      height: 6px;
      background: #e1e5e9;
      border-radius: 3px;
      overflow: hidden;
      margin-bottom: 5px;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(45deg, #667eea, #764ba2);
      border-radius: 3px;
      transition: width 0.3s ease;
    }

    .progress-text {
      font-size: 0.8rem;
      color: #666;
    }

    /* Activity Feed */
    .activity-item {
      display: flex;
      align-items: flex-start;
      padding: 15px 0;
      border-bottom: 1px solid #f1f3f4;
    }

    .activity-item:last-child {
      border-bottom: none;
    }

    .activity-icon {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      color: white;
      margin-right: 12px;
      flex-shrink: 0;
    }

    .activity-icon.completed { background: #28a745; }
    .activity-icon.started { background: #17a2b8; }
    .activity-icon.achievement { background: #ffc107; }

    .activity-content {
      flex: 1;
    }

    .activity-text {
      color: #333;
      font-size: 0.9rem;
      margin-bottom: 3px;
    }

    .activity-time {
      color: #666;
      font-size: 0.8rem;
    }

    /* Quick Actions */
    .quick-actions {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 40px;
    }

    .action-card {
      background: white;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
      text-align: center;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .action-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
    }

    .action-icon {
      width: 60px;
      height: 60px;
      border-radius: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
      color: white;
      margin: 0 auto 15px;
    }

    .action-icon.browse { background: linear-gradient(45deg, #667eea, #764ba2); }
    .action-icon.schedule { background: linear-gradient(45deg, #f093fb, #f5576c); }
    .action-icon.community { background: linear-gradient(45deg, #4facfe, #00f2fe); }
    .action-icon.support { background: linear-gradient(45deg, #43e97b, #38f9d7); }

    .action-title {
      font-weight: 600;
      color: #333;
      margin-bottom: 8px;
    }

    .action-description {
      color: #666;
      font-size: 0.9rem;
    }

    /* Responsive Design */
    @media (max-width: 1024px) {
      .content-grid {
        grid-template-columns: 1fr;
      }
      
      .search-box input {
        width: 200px;
      }
    }

    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-280px);
      }
      
      .sidebar.open {
        transform: translateX(0);
      }
      
      .main-content {
        margin-left: 0;
      }
      
      .menu-toggle {
        display: block;
      }
      
      .header {
        padding: 15px 20px;
      }
      
      .dashboard-content {
        padding: 20px;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
      }
      
      .search-box input {
        width: 150px;
      }
      
      .header-right {
        gap: 10px;
      }
    }

    @media (max-width: 480px) {
      .stat-card {
        padding: 20px;
      }
      
      .section-card {
        padding: 20px;
      }
      
      .course-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
      }
      
      .course-progress {
        width: 100%;
        text-align: left;
      }
    }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <nav class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <div class="logo">Vidyavantra</div>
      <div class="logo-subtitle">Learning Platform</div>
    </div>
    
    <div class="nav-menu">
      <a href="#" class="nav-item active" data-section="overview">
        <i>üè†</i> Dashboard
      </a>

    </div>
    
    <div class="user-profile" id="userProfile">
      <div class="profile-info">
        <div class="profile-avatar" id="profileAvatar">--</div>
        <div class="profile-details">
      <h4 id="profileName"></h4>
          <p id="profileRole">Member</p>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="main-content" id="mainContent">
    <!-- Header -->
    <header class="header">
      <div class="header-left">
        <button class="menu-toggle" id="menuToggle">‚ò∞</button>
        <h1 class="page-title">Dashboard</h1>
        <button onclick="window.location.href='/'" style="margin-left:12px; padding:6px 10px; border-radius:8px; border:none; background:#667eea; color:#fff; cursor:pointer;">Home</button>
        <button onclick="showSection('support')" style="margin-left:12px; padding:6px 10px; border-radius:8px; border:none; background:#28a745; color:#fff; cursor:pointer;">Show Support</button>
      </div>
      
      <div class="header-right">
        <!-- Search bar and notification removed per request -->
      </div>
    </header>

    <!-- Dashboard Content -->
    <div class="dashboard-content">
      <!-- Stats Cards -->
      <div id="section-overview" class="dashboard-section">
        <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-header">
            <div class="stat-icon courses">üìö</div>
            <div class="stat-change positive">+2 this week</div>
          </div>
          <div class="stat-value">12</div>
          <div class="stat-label">Enrolled Courses</div>
        </div>
        
        <div class="stat-card">
          <div class="stat-header">
            <div class="stat-icon progress">üìà</div>
            <div class="stat-change positive">+15% this month</div>
          </div>
          <div class="stat-value">68%</div>
          <div class="stat-label">Overall Progress</div>
        </div>
        
        <div class="stat-card">
          <div class="stat-header">
            <div class="stat-icon certificates">üèÜ</div>
            <div class="stat-change positive">+1 this week</div>
          </div>
          <div class="stat-value">5</div>
          <div class="stat-label">Certificates Earned</div>
        </div>
        
        <div class="stat-card">
          <div class="stat-header">
            <div class="stat-icon hours">‚è±Ô∏è</div>
            <div class="stat-change positive">+8h this week</div>
          </div>
          <div class="stat-value">124</div>
          <div class="stat-label">Learning Hours</div>
        </div>
        </div>
      </div>

      <!-- Content Grid -->
      <div class="content-grid">
          <!-- Recent Activity (expanded to full width) -->
          <div class="section-card">
            <div class="section-header">
              <h2 class="section-title">Recent Activity</h2>
              <a href="#" class="view-all-btn">View All ‚Üí</a>
            </div>

            <div id="activityContainer">
              <!-- Activities will be loaded here -->
            </div>

            <div style="margin-top:18px;">
              <h3 style="margin-bottom:10px;">My Saves</h3>
              <div id="mySavesContainer">
                <p style="color:#666">Loading saved items...</p>
              </div>
            </div>

          </div>
      </div>

      <!-- News Section -->
      <div id="section-news" class="dashboard-section" style="display:none;">
        <div class="search-section">
          <div class="search-header">
            <h1 class="search-title">My Saved News</h1>
            <p class="search-subtitle">Your bookmarked and saved news articles</p>
          </div>
        </div>

        <div class="news-grid" id="savedNewsGrid">
          <!-- Saved news articles will be populated here -->
        </div>
      </div>

      <!-- Help & Support (moved out of My Courses) -->
      <div id="section-support" class="dashboard-section" style="display:none;">
        <div style="background: #dc3545; color: white; padding: 20px; text-align: center; font-size: 1.5rem; font-weight: bold; border-radius: 10px; margin-bottom: 20px;">
          üö® SUPPORT SECTION - NEED HELP? üö®
        </div>

        <div class="section-card" style="background: #f5f5f5; padding: 0; border-radius: 0; box-shadow: none;">
          <!-- Hero Section -->
          <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 60px 40px; text-align: center;">
            <h1 style="font-size: 3rem; font-weight: bold; margin-bottom: 20px; color: white;">How can we help you?</h1>
            <p style="font-size: 1.2rem; opacity: 0.9; max-width: 800px; margin: 0 auto; line-height: 1.6;">
              Our dedicated support team is here to assist you with any questions or issues you may have. 
              We're committed to providing excellent service and ensuring your learning journey is smooth and successful.
            </p>
          </div>

          <!-- Contact Cards Grid -->
          <div style="background: #f5f5f5; padding: 60px 40px;">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; max-width: 1200px; margin: 0 auto;">
              
              <!-- Main Office Card -->
              <div style="background: white; padding: 40px 30px; border-radius: 10px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1); transition: transform 0.3s ease;">
                <div style="font-size: 3rem; color: #667eea; margin-bottom: 20px;">üìç</div>
                <h3 style="color: #333; font-size: 1.3rem; font-weight: bold; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px;">OUR MAIN OFFICE</h3>
                <p style="color: #666; font-size: 1rem; line-height: 1.5; margin: 0;">
                  Vidyavantra Learning Center<br>
                  MBTS Govt polytechnic,<br>
                   Guntur 522005<br>
                </p>
              </div>

              <!-- Phone Number Card -->
              <div style="background: white; padding: 40px 30px; border-radius: 10px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1); transition: transform 0.3s ease;">
                <div style="font-size: 3rem; color: #667eea; margin-bottom: 20px;">üìû</div>
                <h3 style="color: #333; font-size: 1.3rem; font-weight: bold; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px;">PHONE NUMBER</h3>
                <p style="color: #666; font-size: 1rem; line-height: 1.5; margin: 0;">
                  +91 63053 74609<br>
                  +91 75690 23459<br>
                </p>
              </div>
<
              <!-- Email Card -->
              <div style="background: white; padding: 40px 30px; border-radius: 10px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1); transition: transform 0.3s ease;">
                <div style="font-size: 3rem; color: #667eea; margin-bottom: 20px;">‚úâÔ∏è</div>
                <h3 style="color: #333; font-size: 1.3rem; font-weight: bold; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px;">EMAIL</h3>
                <p style="color: #667eea; font-size: 1rem; line-height: 1.5; margin: 0;">
                  <a href="mailto:support@vidyavantra.com" style="color: #667eea; text-decoration: none;">support@vidyavantra.com</a>
                </p>
              </div>

              <!-- Live Chat Card -->
              <div style="background: white; padding: 40px 30px; border-radius: 10px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1); transition: transform 0.3s ease;">
                <div style="font-size: 3rem; color: #667eea; margin-bottom: 20px;">üí¨</div>
                <h3 style="color: #333; font-size: 1.3rem; font-weight: bold; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px;">LIVE CHAT</h3>
                <p style="color: #666; font-size: 1rem; line-height: 1.5; margin: 0;">
                  Available 24/7<br>
                  <span style="color: #28a745; font-weight: bold;">Online Now</span>
                </p>
              </div>
            </div>
          </div>

          <!-- Website Information Section -->
          <div style="background: white; padding: 60px 40px; border-bottom: 1px solid #e1e5e9;">
            <div style="max-width: 1200px; margin: 0 auto;">
              <h2 style="color: #333; font-size: 2.5rem; margin-bottom: 40px; text-align: center;">About Vidyavantra Learning Platform</h2>
              
              <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; margin-bottom: 40px;">
                
                <!-- Platform Features -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 15px;">
                  <h3 style="color: white; font-size: 1.5rem; margin-bottom: 20px; text-align: center;">üéØ Our Platform Features</h3>
                  <ul style="list-style: none; padding: 0; margin: 0;">
                    <li style="margin-bottom: 12px; display: flex; align-items: center;">
                      <span style="margin-right: 10px;">üìö</span> Interactive Course Library
                    </li>
                    <li style="margin-bottom: 12px; display: flex; align-items: center;">
                      <span style="margin-right: 10px;">üé•</span> Video Tutorials & Learning Paths
                    </li>
                    <li style="margin-bottom: 12px; display: flex; align-items: center;">
                      <span style="margin-right: 10px;">üìä</span> Progress Tracking & Analytics
                    </li>
                    <li style="margin-bottom: 12px; display: flex; align-items: center;">
                      <span style="margin-right: 10px;">üèÜ</span> Certificates & Achievements
                    </li>
                    <li style="margin-bottom: 12px; display: flex; align-items: center;">
                      <span style="margin-right: 10px;">üíº</span> Job Search & Career Guidance
                    </li>
                    <li style="margin-bottom: 12px; display: flex; align-items: center;">
                      <span style="margin-right: 10px;">üìÖ</span> Expert Session Booking
                    </li>
                  </ul>
                </div>

                <!-- Learning Categories -->
                <div style="background: #f8f9fa; padding: 30px; border-radius: 15px; border-left: 5px solid #28a745;">
                  <h3 style="color: #333; font-size: 1.5rem; margin-bottom: 20px; text-align: center;">üìñ Learning Categories</h3>
                  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div style="background: white; padding: 15px; border-radius: 8px; text-align: center;">
                      <div style="font-size: 1.5rem; margin-bottom: 8px;">üíª</div>
                      <div style="font-weight: 600; color: #333;">Programming</div>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 8px; text-align: center;">
                      <div style="font-size: 1.5rem; margin-bottom: 8px;">üé®</div>
                      <div style="font-weight: 600; color: #333;">Design</div>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 8px; text-align: center;">
                      <div style="font-size: 1.5rem; margin-bottom: 8px;">üìä</div>
                      <div style="font-weight: 600; color: #333;">Data Science</div>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 8px; text-align: center;">
                      <div style="font-size: 1.5rem; margin-bottom: 8px;">üìà</div>
                      <div style="font-weight: 600; color: #333;">Marketing</div>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 8px; text-align: center;">
                      <div style="font-size: 1.5rem; margin-bottom: 8px;">üíº</div>
                      <div style="font-weight: 600; color: #333;">Business</div>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 8px; text-align: center;">
                      <div style="font-size: 1.5rem; margin-bottom: 8px;">üì∏</div>
                      <div style="font-weight: 600; color: #333;">Photography</div>
                    </div>
                  </div>
                </div>

                <!-- Platform Stats -->
                <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 30px; border-radius: 15px;">
                  <h3 style="color: white; font-size: 1.5rem; margin-bottom: 20px; text-align: center;">üìà Platform Statistics</h3>
                  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div style="text-align: center;">
                      <div style="font-size: 2rem; font-weight: bold; margin-bottom: 5px;">10K+</div>
                      <div style="font-size: 0.9rem; opacity: 0.9;">Active Learners</div>
                    </div>
                    <div style="text-align: center;">
                      <div style="font-size: 2rem; font-weight: bold; margin-bottom: 5px;">500+</div>
                      <div style="font-size: 0.9rem; opacity: 0.9;">Courses Available</div>
                    </div>
                    <div style="text-align: center;">
                      <div style="font-size: 2rem; font-weight: bold; margin-bottom: 5px;">50+</div>
                      <div style="font-size: 0.9rem; opacity: 0.9;">Expert Instructors</div>
                    </div>
                    <div style="text-align: center;">
                      <div style="font-size: 2rem; font-weight: bold; margin-bottom: 5px;">95%</div>
                      <div style="font-size: 0.9rem; opacity: 0.9;">Success Rate</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Additional Support Information -->
            <div style="background: white; padding: 60px 40px;">
              <div style="max-width: 1200px; margin: 0 auto;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 60px; align-items: start;">
                  
                  <!-- FAQ Section -->
                  <div>
                    <h2 style="color: #333; font-size: 2rem; margin-bottom: 30px; text-align: center;">Frequently Asked Questions</h2>
                    
                    <div style="margin-bottom: 20px;">
                      <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #667eea; margin-bottom: 15px;">
                        <h4 style="color: #333; margin-bottom: 8px; font-size: 1.1rem;">How do I reset my password?</h4>
                        <p style="color: #666; margin: 0; line-height: 1.5;">Click the "Reset Password" link on the login page, enter your email, and follow the instructions sent to your inbox.</p>
                      </div>

                      <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #28a745; margin-bottom: 15px;">
                        <h4 style="color: #333; margin-bottom: 8px; font-size: 1.1rem;">How do I save a tutorial?</h4>
                        <p style="color: #666; margin: 0; line-height: 1.5;">Click the üíæ Save button on any tutorial or learning path. It will appear in your "My Saves" section on the dashboard.</p>
                      </div>

                      <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #ffc107; margin-bottom: 15px;">
                        <h4 style="color: #333; margin-bottom: 8px; font-size: 1.1rem;">How do I get certificates?</h4>
                        <p style="color: #666; margin: 0; line-height: 1.5;">Certificates are automatically issued after completing a course. Check your "Achievements" section or contact support if there's an issue.</p>
                      </div>

                      <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #dc3545; margin-bottom: 15px;">
                        <h4 style="color: #333; margin-bottom: 8px; font-size: 1.1rem;">How do I track my learning progress?</h4>
                        <p style="color: #666; margin: 0; line-height: 1.5;">Your progress is automatically tracked when you complete modules. View your progress in the "Progress" section of your dashboard.</p>
                      </div>

                      <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #6f42c1; margin-bottom: 15px;">
                        <h4 style="color: #333; margin-bottom: 8px; font-size: 1.1rem;">How do I book an expert session?</h4>
                        <p style="color: #666; margin: 0; line-height: 1.5;">Go to the "Schedule" section in your dashboard, select an expert, choose your preferred time, and book your 1-on-1 session.</p>
                      </div>

                      <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #20c997; margin-bottom: 15px;">
                        <h4 style="color: #333; margin-bottom: 8px; font-size: 1.1rem;">What learning paths are available?</h4>
                        <p style="color: #666; margin: 0; line-height: 1.5;">We offer structured learning paths in Programming, Data Science, Design, Marketing, and Business. Each path includes multiple courses and projects.</p>
                      </div>

                      <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #fd7e14; margin-bottom: 15px;">
                        <h4 style="color: #333; margin-bottom: 8px; font-size: 1.1rem;">How do I access job opportunities?</h4>
                        <p style="color: #666; margin: 0; line-height: 1.5;">Visit the "News" section to find the latest job postings. You can also save job listings to your dashboard for easy access.</p>
                      </div>

                      <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #e83e8c; margin-bottom: 15px;">
                        <h4 style="color: #333; margin-bottom: 8px; font-size: 1.1rem;">Is there a mobile app available?</h4>
                        <p style="color: #666; margin: 0; line-height: 1.5;">Currently, Vidyavantra is optimized for web browsers. A mobile app is in development and will be available soon.</p>
                      </div>
                    </div>
                  </div>

                  <!-- Contact Form -->
                  <div>
                    <h2 style="color: #333; font-size: 2rem; margin-bottom: 30px; text-align: center;">Send us a message</h2>
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; text-align: center;">
                      <h3 style="color: white; margin: 0; font-size: 1.2rem;">üìß Direct Contact</h3>
                      <p style="color: white; margin: 10px 0 0 0; opacity: 0.9;">For immediate assistance, email us directly at <strong>vidyavantra@gmail.com</strong></p>
                    </div>
                    
                    <form id="supportForm" style="background: #f8f9fa; padding: 30px; border-radius: 10px;">
                      <div style="display: flex; flex-direction: column; gap: 20px;">
                        <div>
                          <label style="display: block; margin-bottom: 8px; color: #333; font-weight: 500; font-size: 1rem;">Your Name *</label>
                          <input id="supportName" placeholder="Enter your full name" required style="width: 100%; padding: 12px; border: 1px solid #e1e5e9; border-radius: 6px; font-size: 14px; background: white;" />
                        </div>
                        
                        <div>
                          <label style="display: block; margin-bottom: 8px; color: #333; font-weight: 500; font-size: 1rem;">Email Address *</label>
                          <input id="supportEmail" type="email" placeholder="your.email@example.com" required style="width: 100%; padding: 12px; border: 1px solid #e1e5e9; border-radius: 6px; font-size: 14px; background: white;" />
                        </div>

                        <div>
                          <label style="display: block; margin-bottom: 8px; color: #333; font-weight: 500; font-size: 1rem;">Issue Type</label>
                          <select id="supportIssueType" style="width: 100%; padding: 12px; border: 1px solid #e1e5e9; border-radius: 6px; font-size: 14px; background: white;">
                            <option value="general">General Inquiry</option>
                            <option value="technical">Technical Issue</option>
                            <option value="account">Account Problem</option>
                            <option value="course">Course Content</option>
                            <option value="billing">Billing Question</option>
                            <option value="feature">Feature Request</option>
                            <option value="feedback">Feedback & Suggestions</option>
                            <option value="partnership">Partnership Inquiry</option>
                          </select>
                        </div>

                        <div>
                          <label style="display: block; margin-bottom: 8px; color: #333; font-weight: 500; font-size: 1rem;">Priority Level</label>
                          <select id="supportPriority" style="width: 100%; padding: 12px; border: 1px solid #e1e5e9; border-radius: 6px; font-size: 14px; background: white;">
                            <option value="low">Low - General question</option>
                            <option value="medium" selected>Medium - Need assistance</option>
                            <option value="high">High - Urgent issue</option>
                          </select>
                        </div>
                        
                        <div>
                          <label style="display: block; margin-bottom: 8px; color: #333; font-weight: 500; font-size: 1rem;">Message *</label>
                          <textarea id="supportMessage" placeholder="Describe your issue or question in detail. Please include any error messages, steps to reproduce the issue, or specific questions you have..." required style="width: 100%; padding: 12px; min-height: 120px; border: 1px solid #e1e5e9; border-radius: 6px; font-size: 14px; resize: vertical; background: white;"></textarea>
                        </div>

                        <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; border-left: 4px solid #2196f3;">
                          <h4 style="color: #1976d2; margin: 0 0 8px 0; font-size: 1rem;">üí° Quick Tips for Better Support</h4>
                          <ul style="color: #666; margin: 0; padding-left: 20px; font-size: 0.9rem;">
                            <li>Be specific about the issue you're experiencing</li>
                            <li>Include any error messages you see</li>
                            <li>Mention which browser/device you're using</li>
                            <li>Describe what you were trying to do when the issue occurred</li>
                          </ul>
                        </div>
                        
                        <div style="display: flex; gap: 15px; margin-top: 20px;">
                          <button type="submit" style="flex: 1; padding: 15px 25px; border-radius: 6px; border: none; background: #667eea; color: white; font-weight: 500; cursor: pointer; font-size: 1rem; transition: background 0.3s ease;">üì§ Send Message</button>
                          <button type="button" id="supportHomeBtn" style="padding: 15px 25px; border-radius: 6px; border: 1px solid #e1e5e9; background: white; color: #333; cursor: pointer; font-size: 1rem; transition: background 0.3s ease;">üè† Home</button>
                        </div>
                        
                        <div id="supportResult" style="color: #666; margin-top: 15px; padding: 15px; border-radius: 6px; display: none; text-align: center;"></div>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>
      <div class="quick-actions">
        <div class="action-card" onclick="browseCoursesAction()">
          <div class="action-icon browse">üîç</div>
          <div class="action-title">Browse Courses</div>
          <div class="action-description">Discover new courses and expand your skills</div>
        </div>

        <div class="action-card" onclick="joinCommunityAction()">
          <div class="action-icon community">üë•</div>
          <div class="action-title">Join Community</div>
          <div class="action-description">Connect with fellow learners</div>
        </div>

        <div class="action-card" onclick="showSection('support')">
          <div class="action-icon support">‚ùì</div>
          <div class="action-title">Help & Support</div>
          <div class="action-description">Get help and support when you need it</div>
        </div>
      </div>
    </div>
  </main>

  <script>
    // Mobile menu toggle
    const menuToggle = document.getElementById('menuToggle');
    const sidebar = document.getElementById('sidebar');
    const mainContent = document.getElementById('mainContent');

    menuToggle.addEventListener('click', function() {
      sidebar.classList.toggle('open');
    });

    // Close sidebar when clicking outside on mobile
    document.addEventListener('click', function(e) {
      if (window.innerWidth <= 768) {
        if (!sidebar.contains(e.target) && !menuToggle.contains(e.target)) {
          sidebar.classList.remove('open');
        }
      }
    });

    // Navigation item clicks - show/hide sections by data-section
    function showSection(name) {
      // hide all dashboard-section blocks
      document.querySelectorAll('.dashboard-section').forEach(el => {
        el.style.display = 'none';
      });

      // hide the specific per-section wrappers
      const sections = ['overview','courses','settings','support'];
      sections.forEach(s => {
        const sec = document.getElementById('section-' + s);
        if (sec) sec.style.display = 'none';
      });

      // show selected section
      const selected = document.getElementById('section-' + name);
      if (selected) {
        selected.style.display = 'block';
        console.log('Showing section:', name, selected);
      } else {
        console.log('Section not found:', 'section-' + name);
      }

      // Special handling for overview section
      if (name === 'overview') {
        // No special handling needed since content is always shown
      }

      // Special handling for news section
      if (name === 'news') {
        loadSavedNews();
      }

      // update title
      const titleMap = {
        overview: 'Dashboard',
        news: 'My Saved News',
        courses: 'My Courses',
        settings: 'Settings',
        support: 'Help & Support'
      };
      document.querySelector('.page-title').textContent = titleMap[name] || 'Dashboard';

      // record activity
      recordActivity('note', `Viewed ${titleMap[name] || name}`);

      // if user opened My Courses, load full course list
      if (name === 'courses') {
        awaitLoadMyCourses();
      }
    }

    async function awaitLoadMyCourses() {
      try {
        // if the continueLearningContainer is not present (we removed the card), exit early
        const container = document.getElementById('continueLearningContainer');
        if (!container) return;

        // load up to 100 courses (should be enough for most users)
        const resp = await fetch('/api/dashboard/continue_learning?limit=100', { credentials: 'same-origin' });
        if (!resp.ok) return;
        const courses = await resp.json();
        container.innerHTML = '';
        courses.forEach(c => container.appendChild(renderCourseItem(c)));
      } catch (e) {
        console.error('Failed to load my courses', e);
      }
    }

    document.querySelectorAll('.nav-item').forEach(item => {
      item.addEventListener('click', function(e) {
        e.preventDefault();
        document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
        this.classList.add('active');
        const section = this.dataset.section || 'overview';
        showSection(section);
        // Close sidebar on mobile
        if (window.innerWidth <= 768) sidebar.classList.remove('open');
      });
    });

    // Quick action functions
    function browseCoursesAction() {
      // Navigate to courses section instead of showing alert
      showSection('courses');
    }

    function joinCommunityAction() {
      // Navigate to community or show community info
      alert('Community features coming soon!');
    }

    // Search functionality and notification removed per request

    // ------------ User & Activity Feed Integration ------------
    async function fetchCurrentUser() {
      try {
        const resp = await fetch('/api/user', { credentials: 'same-origin' });
        if (!resp.ok) return null;
        const user = await resp.json();
        return user;
      } catch (e) {
        return null;
      }
    }

    function setUserProfile(user) {
      if (!user) return;
      // Build a friendly display name with fallbacks
      const first = (user.first_name || '').trim();
      const last = (user.last_name || '').trim();
      const username = (user.username || '').trim();
      const email = (user.email || '').trim();
      const displayName = first || last ? `${first} ${last}`.trim() : (username || email || 'Member');

      // Avatar: initials from name or username/email
      let initials = '';
      if (first) initials += first[0];
      if (last) initials += last[0];
      if (!initials && username) initials = username[0];
      if (!initials && email) initials = email[0];

      document.getElementById('profileAvatar').textContent = (initials || '--').toUpperCase();
      document.getElementById('profileName').textContent = displayName;
      document.getElementById('profileRole').textContent = user.is_premium ? 'Premium Member' : 'Member';
    }

    // Expose a helper to refresh current user profile (useful to call after login)
    window.refreshCurrentUser = async function() {
      const user = await fetchCurrentUser();
      if (user) setUserProfile(user);
      return user;
    };

    // Listen for a custom event 'user-logged-in' so other parts of the app
    // (for example the login flow) can dispatch it and cause the dashboard
    // to refresh the profile without a full page reload.
    window.addEventListener('user-logged-in', async function() {
      await window.refreshCurrentUser();
    });

    // Also refresh profile when window gains focus (covers login in another tab)
    window.addEventListener('focus', async function() {
      await window.refreshCurrentUser();
    });

    function showLoginBanner() {
      let b = document.getElementById('loginBanner');
      if (!b) {
        b = document.createElement('div');
        b.id = 'loginBanner';
        b.style.padding = '12px 20px';
        b.style.background = '#fff3cd';
        b.style.color = '#856404';
        b.style.border = '1px solid #ffeeba';
        b.style.borderRadius = '8px';
        b.style.marginBottom = '16px';
        b.textContent = 'You are not signed in. Please login to see your courses and activity.';
        const dash = document.querySelector('.dashboard-content');
        if (dash) dash.prepend(b);
      }
    }

    async function fetchActivityFeed() {
      try {
        const resp = await fetch('/api/dashboard/activity_feed', { credentials: 'same-origin' });
        if (!resp.ok) return [];
        const list = await resp.json();
        return list;
      } catch (e) {
        return [];
      }
    }

    function renderActivities(activities) {
      const container = document.getElementById('activityContainer');
      container.innerHTML = '';
      if (!activities || activities.length === 0) {
        container.innerHTML = '<p style="color:#666">No recent activity yet. Your actions will appear here.</p>';
        return;
      }

      activities.forEach(act => {
        const item = document.createElement('div');
        item.className = 'activity-item';

        const icon = document.createElement('div');
        icon.className = 'activity-icon ' + (act.activity_type || 'started');
        // Simple emoji mapping
        const map = { 'completed': '‚úì', 'started': '‚ñ∂Ô∏è', 'achievement': 'üèÜ', 'note': '‚Ä¢' };
        icon.textContent = map[act.activity_type] || '‚Ä¢';

        const content = document.createElement('div');
        content.className = 'activity-content';

        const text = document.createElement('div');
        text.className = 'activity-text';
        text.textContent = act.description;

        const time = document.createElement('div');
        time.className = 'activity-time';
        // display relative time if available
        try {
          const t = new Date(act.timestamp);
          const diff = Math.floor((Date.now() - t.getTime()) / 1000);
          if (diff < 60) time.textContent = `${diff}s ago`;
          else if (diff < 3600) time.textContent = `${Math.floor(diff/60)}m ago`;
          else if (diff < 86400) time.textContent = `${Math.floor(diff/3600)}h ago`;
          else time.textContent = `${Math.floor(diff/86400)}d ago`;
        } catch (e) {
          time.textContent = act.timestamp || '';
        }

        content.appendChild(text);
        content.appendChild(time);

        item.appendChild(icon);
        item.appendChild(content);

        container.appendChild(item);
      });
    }

    async function recordActivity(type, description) {
      try {
        const resp = await fetch('/api/dashboard/activity', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          credentials: 'same-origin',
          body: JSON.stringify({ type: type, description: description })
        });
        if (resp.ok) {
          // Refresh feed
          const acts = await fetchActivityFeed();
          renderActivities(acts);
        } else if (resp.status === 401) {
          // unauthorized - show banner
          showLoginBanner();
          console.warn('Recording activity failed: unauthorized (not signed in)');
        } else {
          console.warn('Failed to record activity', await resp.text());
        }
      } catch (e) {
        console.error('Error recording activity', e);
      }
    }

    // Wire up UI interactions to record activities
    document.querySelectorAll('.nav-item').forEach(item => {
      item.addEventListener('click', function(e) {
        const title = this.textContent.trim();
        recordActivity('note', `Navigated to ${title}`);
      });
    });

    // Quick actions
    function browseCoursesAction() {
      recordActivity('started', 'Browsed course catalog');
      showSection('courses');
    }

    function scheduleSessionAction() {
      // Schedule feature removed - direct users to Support
      alert('Scheduling has been removed. Please use Help & Support to request sessions.');
      showSection('support');
    }

    function joinCommunityAction() {
      recordActivity('note', 'Visited community');
      alert('Community features coming soon!');
    }

    function getSupportAction() {
      recordActivity('note', 'Opened support chat');
      showSection('support');
    }

    // Hook search
    document.querySelector('.search-box input').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        const searchTerm = this.value.trim();
        if (searchTerm) {
          recordActivity('note', `Searched for: ${searchTerm}`);
          alert(`Searching for: ${searchTerm}`);
        }
      }
    });

    // Notification removed per request

    // Load user and feed on page load
    window.addEventListener('load', async function() {
      const user = await fetchCurrentUser();
      if (user) setUserProfile(user);
    const activities = await fetchActivityFeed();
    renderActivities(activities);
    // 'Continue Learning' card removed from dashboard; do not automatically load it here
    // load saved items
    await loadUserSaves();
      // support home button
      const supportHomeBtn = document.getElementById('supportHomeBtn');
      if (supportHomeBtn) supportHomeBtn.addEventListener('click', function() {
        recordActivity('note', 'Clicked Home from Help & Support');
        window.location.href = '/';
      });
      
      // Schedule feature removed; no schedule form handling
      const supportForm = document.getElementById('supportForm');
      if (supportForm) {
        supportForm.addEventListener('submit', async function(evt) {
          evt.preventDefault();
          const name = document.getElementById('supportName').value.trim();
          const email = document.getElementById('supportEmail').value.trim();
          const message = document.getElementById('supportMessage').value.trim();
          const issueType = document.getElementById('supportIssueType').value;
          const priority = document.getElementById('supportPriority').value;
          const result = document.getElementById('supportResult');
          result.textContent = '';
          result.style.display = 'block';
          
          if (!email || !message || !name) { 
            result.style.color = '#721c24';
            result.style.background = '#f8d7da';
            result.textContent = 'Please fill in all required fields (Name, Email, and Message).'; 
            return; 
          }
          
          try {
            const supportData = {
              name: name,
              email: email,
              message: `[${priority.toUpperCase()}] ${issueType}: ${message}`,
              issue_type: issueType,
              priority: priority
            };
            
            const resp = await fetch('/api/support_request', { 
              method: 'POST', 
              headers: { 'Content-Type': 'application/json' }, 
              body: JSON.stringify(supportData) 
            });
            const data = await resp.json();
            
            if (resp.ok) {
              result.style.color = '#155724';
              result.style.background = '#d4edda';
              result.textContent = '‚úÖ ' + (data.message || 'Support request sent successfully! Our team will contact you soon at ' + email);
              recordActivity('support', `Submitted ${priority} priority support request: ${issueType}`);
              supportForm.reset();
              
              // Show additional info
              setTimeout(() => {
                result.innerHTML += '<br><br><strong>üìß Direct Contact:</strong> For urgent matters, you can also email us directly at <a href="mailto:vidyavantra@gmail.com" style="color: #667eea;">vidyavantra@gmail.com</a>';
              }, 1000);
            } else {
              result.style.color = '#721c24';
              result.style.background = '#f8d7da';
              result.textContent = '‚ùå ' + (data.message || 'Failed to send support request. Please try again.');
            }
          } catch (e) {
            result.style.color = '#721c24';
            result.style.background = '#f8d7da';
            result.textContent = '‚ùå Failed to send support request. Please check your internet connection and try again.';
            console.error('Support request error:', e);
          }
        });
      }
      // show default section
      showSection('overview');

      // Load saved news for news section
      loadSavedNews();
      
      // (removed auto-show test so support only appears when user navigates)
    });

    // Load user's saved items
    async function loadUserSaves() {
      try {
        const resp = await fetch('/api/user/saves', { credentials: 'same-origin' });
        const container = document.getElementById('mySavesContainer');
        if (!resp.ok) {
          container.innerHTML = '<p style="color:#666">Unable to load saved items.</p>';
          return;
        }
        const saves = await resp.json();
        if (!saves || saves.length === 0) {
          container.innerHTML = '<p style="color:#666">You have not saved anything yet.</p>';
          return;
        }
        container.innerHTML = '';
        saves.forEach(s => container.appendChild(renderSavedItem(s)));
      } catch (e) {
        const container = document.getElementById('mySavesContainer');
        container.innerHTML = '<p style="color:#666">Failed to load saved items.</p>';
      }
    }

    function renderSavedItem(s) {
      const wrap = document.createElement('div');
      wrap.style.display = 'flex';
      wrap.style.alignItems = 'center';
      wrap.style.justifyContent = 'space-between';
      wrap.style.padding = '10px 0';
      wrap.style.borderBottom = '1px solid #f1f3f4';

      const left = document.createElement('div');
      left.style.display = 'flex';
      left.style.alignItems = 'center';

      const thumb = document.createElement('div');
      thumb.style.width = '48px';
      thumb.style.height = '48px';
      thumb.style.borderRadius = '8px';
      thumb.style.background = '#e9eefb';
      thumb.style.display = 'flex';
      thumb.style.alignItems = 'center';
      thumb.style.justifyContent = 'center';
      thumb.style.marginRight = '12px';
      thumb.textContent = s.thumbnail || 'üîñ';

      const meta = document.createElement('div');
      const title = document.createElement('div');
      title.style.fontWeight = '600';
      title.textContent = s.title;
      const type = document.createElement('div');
      type.style.fontSize = '0.85rem';
      type.style.color = '#666';
      type.textContent = `${s.resource_type} ‚Ä¢ ${new Date(s.created_at).toLocaleString()}`;
      meta.appendChild(title);
      meta.appendChild(type);

      left.appendChild(thumb);
      left.appendChild(meta);

      const right = document.createElement('div');
      right.style.display = 'flex';
      right.style.gap = '8px';

      if (s.external_link) {
        const openBtn = document.createElement('a');
        openBtn.href = s.external_link;
        openBtn.target = '_blank';
        openBtn.style.textDecoration = 'none';
        openBtn.style.padding = '6px 10px';
        openBtn.style.borderRadius = '6px';
        openBtn.style.background = '#667eea';
        openBtn.style.color = '#fff';
        openBtn.textContent = 'Open';
        right.appendChild(openBtn);
      }

      const del = document.createElement('button');
      del.textContent = 'Delete';
      del.style.padding = '6px 10px';
      del.style.borderRadius = '6px';
      del.style.border = '1px solid #e1e5e9';
      del.style.background = '#fff';
      del.addEventListener('click', async function() {
        try {
          const r = await fetch('/api/user/saves/' + s.id, { method: 'DELETE', credentials: 'same-origin' });
          if (r.ok) {
            recordActivity('note', `Removed saved ${s.resource_type}: ${s.title}`);
            loadUserSaves();
          } else {
            console.warn('Failed to delete saved item', await r.text());
          }
        } catch (e) {
          console.error('Delete failed', e);
        }
      });

      right.appendChild(del);

      wrap.appendChild(left);
      wrap.appendChild(right);
      return wrap;
    }

    // Continue Learning rendering and interaction
    async function loadContinueLearning() {
      try {
        // If the continue learning container was removed from the dashboard, do nothing
        const container = document.getElementById('continueLearningContainer');
        if (!container) return;

        const resp = await fetch('/api/dashboard/continue_learning', { credentials: 'same-origin' });
        if (!resp.ok) return;
        const courses = await resp.json();
        container.innerHTML = '';
        if (!courses || courses.length === 0) {
          container.innerHTML = '<p style="color:#666">No active courses found. Enroll in a course or start a learning path to see it here.</p>';
          return;
        }
        courses.forEach(c => container.appendChild(renderCourseItem(c)));
      } catch (e) {
        console.error('Failed to load continue learning', e);
      }
    }

    function renderCourseItem(course) {
      const item = document.createElement('div');
      item.className = 'course-item';
      item.dataset.userCourseId = course.user_course_id;

      const thumb = document.createElement('div');
      thumb.className = 'course-thumbnail';
      thumb.textContent = course.thumbnail || 'üìò';

      const info = document.createElement('div');
      info.className = 'course-info';

      const title = document.createElement('div');
      title.className = 'course-title';
      title.textContent = course.title;

      const meta = document.createElement('div');
      meta.className = 'course-meta';
      meta.textContent = `Module ${course.current_module} of ${course.total_modules} ‚Ä¢ ${course.remaining_hours}h remaining`;

      info.appendChild(title);
      info.appendChild(meta);

      const progressWrap = document.createElement('div');
      progressWrap.className = 'course-progress';

      const progressBar = document.createElement('div');
      progressBar.className = 'progress-bar';
      const fill = document.createElement('div');
      fill.className = 'progress-fill';
      fill.style.width = course.progress_percentage + '%';
      const progressText = document.createElement('div');
      progressText.className = 'progress-text';
      progressText.textContent = course.progress_percentage + '%';

      progressBar.appendChild(fill);
      progressWrap.appendChild(progressBar);
      progressWrap.appendChild(progressText);

      // Add module selector (simple) so user can click to view/select a different module
      const moduleSelector = document.createElement('div');
      moduleSelector.style.marginTop = '10px';
      moduleSelector.style.display = 'flex';
      moduleSelector.style.gap = '6px';

      for (let m = 1; m <= Math.min(course.total_modules, 8); m++) {
        const btn = document.createElement('button');
        btn.className = 'module-btn';
        btn.textContent = m;
        btn.dataset.module = m;
        // highlight current module
        if (m === course.current_module) {
          btn.style.background = '#667eea';
          btn.style.color = '#fff';
        }
        // click handler: set module and update progress
        btn.addEventListener('click', async function() {
          await selectModuleForCourse(course.user_course_id, m, item, fill, progressText, info);
        });
        moduleSelector.appendChild(btn);
      }

      item.appendChild(thumb);
      item.appendChild(info);
      item.appendChild(progressWrap);
      item.appendChild(moduleSelector);

      return item;
    }

    async function selectModuleForCourse(userCourseId, moduleNumber, itemEl, fillEl, progressTextEl, infoEl) {
      try {
        // Compute approximate progress percentage based on module index
        // progress = (moduleNumber / total_modules) * 100
        // But we need total_modules; retrieve from the DOM info text
        const metaText = infoEl.querySelector('.course-meta').textContent;
        const match = metaText.match(/Module\s+(\d+)\s+of\s+(\d+)/i);
        let totalModules = 1;
        if (match) totalModules = parseInt(match[2]);

        const newProgress = Math.round((moduleNumber / totalModules) * 100);

        const resp = await fetch(`/api/user_courses/${userCourseId}/progress`, {
          method: 'PUT',
          headers: { 'Content-Type': 'application/json' },
          credentials: 'same-origin',
          body: JSON.stringify({ current_module: moduleNumber, progress_percentage: newProgress })
        });

        if (resp.ok) {
          // update UI
          fillEl.style.width = newProgress + '%';
          progressTextEl.textContent = newProgress + '%';
          // update module meta
          const metaEl = infoEl.querySelector('.course-meta');
          metaEl.textContent = `Module ${moduleNumber} of ${totalModules} ‚Ä¢ ${metaEl.textContent.split('‚Ä¢').pop().trim()}`;
          // mark module button styles
          itemEl.querySelectorAll('.module-btn').forEach(b => {
            b.style.background = '';
            b.style.color = '';
          });
          const clickedBtn = itemEl.querySelector(`.module-btn[data-module='${moduleNumber}']`);
          if (clickedBtn) { clickedBtn.style.background = '#667eea'; clickedBtn.style.color = '#fff'; }
          // record activity
          recordActivity('started', `Opened ${metaEl.textContent.split('‚Ä¢')[0].trim()} of "${infoEl.querySelector('.course-title').textContent}"`);
        } else {
          console.warn('Failed to update progress', await resp.text());
        }
      } catch (e) {
        console.error('Error selecting module', e);
      }
    }

    // Animate progress bars on load
    window.addEventListener('load', function() {
      const progressBars = document.querySelectorAll('.progress-fill');
      progressBars.forEach(bar => {
        const width = bar.style.width;
        bar.style.width = '0%';
        setTimeout(() => {
          bar.style.width = width;
        }, 500);
      });
    });

    // Animate stats on load
    window.addEventListener('load', function() {
      const statValues = document.querySelectorAll('.stat-value');
      statValues.forEach(stat => {
        const finalValue = stat.textContent;
        const isPercentage = finalValue.includes('%');
        const numericValue = parseInt(finalValue);
        let currentValue = 0;
        const increment = numericValue / 50;
        const timer = setInterval(() => {
          currentValue += increment;
          if (currentValue >= numericValue) {
            currentValue = numericValue;
            clearInterval(timer);
          }
          
          stat.textContent = Math.floor(currentValue) + (isPercentage ? '%' : '');
        }, 30);
      });
    });

    // Load saved news for the news section
    async function loadSavedNews() {
      try {
        const resp = await fetch('/api/user/saves?resource_type=news', { credentials: 'same-origin' });
        if (!resp.ok) {
          document.getElementById('savedNewsGrid').innerHTML = '<p style="color:#666; text-align:center; padding:40px;">Unable to load saved news.</p>';
          return;
        }
        const saves = await resp.json();
        const grid = document.getElementById('savedNewsGrid');
        if (!saves || saves.length === 0) {
          grid.innerHTML = '<p style="color:#666; text-align:center; padding:40px;">No saved news articles yet. Bookmark articles from the News page to see them here.</p>';
          return;
        }
        grid.innerHTML = saves.map(article => `
          <div class="news-card">
            <div class="news-image">${article.thumbnail || 'üì∞'}</div>
            <div class="news-content">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <span class="news-category">${article.category || 'News'}</span>
              </div>
              <h3 class="news-title">${article.title}</h3>
              <p class="news-excerpt">${article.excerpt || ''}</p>
              <div class="news-meta">
                <div class="news-date">
                  üìÖ ${new Date(article.created_at).toLocaleDateString()}
                </div>
                <div class="news-actions">
                  <button class="action-btn" onclick="window.open('${article.external_link}', '_blank')" title="Read Article">üìñ</button>
                  <button class="action-btn" onclick="removeSavedNews(${article.id})" title="Remove from Saves">üóëÔ∏è</button>
                </div>
              </div>
            </div>
          </div>
        `).join('');
      } catch (e) {
        document.getElementById('savedNewsGrid').innerHTML = '<p style="color:#666; text-align:center; padding:40px;">Failed to load saved news.</p>';
      }
    }

    // Remove saved news article
    async function removeSavedNews(id) {
      try {
        const resp = await fetch('/api/user/saves/' + id, { method: 'DELETE', credentials: 'same-origin' });
        if (resp.ok) {
          loadSavedNews(); // Refresh the list
          recordActivity('note', 'Removed saved news article');
        } else {
          alert('Failed to remove article from saves.');
        }
      } catch (e) {
        alert('Error removing article.');
      }
    }

    // Responsive handling
    window.addEventListener('resize', function() {
      if (window.innerWidth > 768) {
        sidebar.classList.remove('open');
      }
    });
  </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96ef622004b71796',t:'MTc1NTE2MzMwMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>